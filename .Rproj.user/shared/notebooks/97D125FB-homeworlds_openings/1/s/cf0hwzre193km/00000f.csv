"0","# aggregate by universe size"
"0","homeworlds_openings |>"
"0","  select(p1_wins, p2_wins, universe_size) |>"
"0","  group_by(universe_size) |>"
"0","  summarize(across(c(p1_wins, p2_wins), sum)) |>"
"0","  rowwise() |>"
"0","  mutate(ci_lower = qbeta(c(0.05, 0.95), 1 + p1_wins, 1 + p2_wins)[1],"
"0","         ci_upper = qbeta(c(0.05, 0.95), 1 + p1_wins, 1 + p2_wins)[2],"
"0","         formatted_ci = paste0(round(100*ci_lower),""-"",round(100*ci_upper),""%""),"
"0","         formatted_ci = case_when(ci_lower > 0.5 | ci_upper < 0.5 ~ paste0(""**"", formatted_ci, ""**""),"
"0","                                  T ~ formatted_ci),"
"0","         universe_size = factor(universe_size, levels = universe_sizes)) |>"
"0","  select(universe_size, formatted_ci) |>"
"0","  arrange(universe_size)"
