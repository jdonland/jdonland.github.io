"0","#| label: cumulative-distributions"
"0","#| warning: false"
"0","#| message: false"
"0","#| code-fold: true"
"0",""
"0","c(`1`=""M"", `2`=""T"", `3`=""W"", `4`=""T"", `5`=""F"", `6`=""S"", `7`=""S"") |>"
"0","  as_labeller() ->"
"0","  day_labeller"
"0",""
"0","crossword_times |>"
"0","  # group by publisher and day, sort by solve time, transform to percentiles"
"0","  group_by(publisher, day) |>"
"0","  arrange(minutes) |>"
"0","  summarize(percentile = cumsum(minutes)/sum(minutes), minutes = minutes) |>"
"0","  ggplot() +"
"0","  # plot structure"
"0","  facet_grid(rows = vars(day), labeller = day_labeller) +"
"0","  # aesthetic mapping"
"0","  aes(x = minutes, y = percentile, colour = publisher) +"
"0","  # visual elements representing the data"
"0","  geom_line(size = 2, alpha = 0.75) +"
"0","  # scales"
"0","  scale_y_continuous(labels = scales::label_percent(),"
"0","                     limits = c(0, NA),"
"0","                     expand = c(0 ,0),"
"0","                     sec.axis = sec_axis(~ ., "
"0","                                         labels = NULL, "
"0","                                         breaks = NULL, "
"0","                                         name = ""Day of the Week\n"")) +"
"0","  scale_x_continuous(n.breaks = 12, minor_breaks = 0:65) +"
"0","  scale_colour_viridis(discrete = TRUE) +"
"0","  # labels"
"0","  labs(title = ""Crossword Solve Times"", "
"0","       subtitle = ""Cumulative distribution by publisher and day of the week"","
"0","       x = ""Time (Minutes)"", "
"0","       y = """","
"0","       colour = NULL) +"
"0","  # theming"
"0","  theme_bw() +"
"0","  theme(legend.position = ""top"", "
"0","        panel.spacing.y = unit(0.02, ""npc""),"
"0","        axis.text.y = element_text(size = rel(0.8)),"
"0","        panel.grid.minor.y = element_blank(),"
"0","        panel.grid.minor.x = element_line(linetype = 3),"
"0","        legend.margin = margin(0, 0, 0, 0),"
"0","        strip.text = element_text(hjust = 0.5))"
